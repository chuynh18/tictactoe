var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,d){a!=Array.prototype&&a!=Object.prototype&&(a[b]=d.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
var gameBoard=[[0,0,0],[0,0,0],[0,0,0]],turn=1,turns=0,winner=0,mode=0,record={p1:0,p2:0,ties:0},ls=window.localStorage,saveRecord=function(){ls.setItem("record",JSON.stringify(record))},loadRecord=function(){var a=JSON.parse(ls.getItem("record"));a&&(a=$jscomp.makeIterator([a.p1,a.p2,a.ties]),record.p1=a.next().value,record.p2=a.next().value,record.ties=a.next().value)},reset=function(){gameBoard=[[0,0,0],[0,0,0],[0,0,0]];turn=1;mode=winner=turns=0;refreshDisplay();modifyEventHandlers("");document.getElementById("board").classList.add("hidden");
var a=document.getElementById("turn");a.textContent="Play as...";var b=document.createElement("div");b.id="start-buttons";var d=document.createElement("button"),m=document.createElement("button"),k=document.createElement("button"),e=document.createElement("button");d.textContent="Human vs Human";d.setAttribute("onclick","mode=1;showBoard();refreshDisplay();modifyEventHandlers('getCellCoords(event)');");m.textContent="Human vs CPU";m.setAttribute("onclick","mode=2;showBoard();refreshDisplay();modifyEventHandlers('getCellCoords(event)')");
k.textContent="CPU vs Human";k.setAttribute("onclick","mode=3;showBoard();modifyEventHandlers('');refreshDisplay();setTimeout(play,500)");e.textContent="Spectate CPU vs CPU";e.setAttribute("onclick","mode=4;showBoard();modifyEventHandlers('');refreshDisplay();setTimeout(play,900)");b.appendChild(d);b.appendChild(m);b.appendChild(k);b.appendChild(e);a.appendChild(b)},highlight=function(a,b){var d=Math.floor(Number(b.target.id)/3),m=Number(b.target.id)%3;a&&!gameBoard[d][m]&&(2===mode&&1===turn||3===
mode&&2===turn||1===mode)?b.target.classList.add("hover"):a||b.target.classList.remove("hover")},playSound=function(a){(new Audio(a)).play()},changeTurn=function(){1===turn?(playSound("x.webm"),turn++):(playSound("o.webm"),turn--);turns++},modifyEventHandlers=function(a){for(var b=document.getElementsByClassName("grid-item"),d=0;d<b.length;d++)b[d].setAttribute("onclick",a)},showBoard=function(){document.getElementById("board").classList.remove("hidden")},refreshDisplay=function(){var a=document.getElementById("turn"),
b=document.getElementsByTagName("html")[0],d=document.getElementById("board");1===winner?(record.p1++,a.textContent="Player 1 wins",b.style.backgroundColor="#778899",d.style.backgroundColor="#2196F3"):2===winner?(record.p2++,a.textContent="Player 2 wins",b.style.backgroundColor="#aa8484",d.style.backgroundColor="#f32121"):-1===winner?(record.ties++,a.textContent="Tied game",b.style.backgroundColor="#c4fcc2",d.style.backgroundColor="#36fc2f"):!winner&&mode&&(1===turn?(b.style.backgroundColor="#778899",
d.style.backgroundColor="#2196F3",a.textContent="Player 1's turn"):(b.style.backgroundColor="#aa8484",d.style.backgroundColor="#f32121",a.textContent="Player 2's turn"));document.getElementById("score").innerHTML="Player 1 wins: "+record.p1+"<br>Player 2 wins: "+record.p2+"<br>Ties: "+record.ties;winner&&(a=document.createElement("div"),a.id="start-buttons",b=document.createElement("button"),b.textContent="Play again!",b.setAttribute("onclick","reset();"),a.appendChild(b),document.getElementById("turn").appendChild(a),
saveRecord());for(a=0;a<gameBoard.length;a++)for(b=0;b<gameBoard[a].length;b++)d=document.getElementById(String(gameBoard.length*a+b)),1===gameBoard[a][b]?(d.textContent="X",d.classList.add("x")):2===gameBoard[a][b]?(d.textContent="O",d.classList.add("o")):(d.textContent="",d.classList.remove("x","xWin","o","oWin"))},cellCheck=function(a){return gameBoard[a.row][a.column]},getCellCoords=function(a){updateCell({row:Math.floor(Number(a.target.id)/3),column:Math.floor(Number(a.target.id)%3)})},updateCell=
function(a){cellCheck(a)||winner||((gameBoard[a.row][a.column]=turn,changeTurn(),checkWinner(),refreshDisplay(),2!==mode||winner)?3!==mode||winner?4!==mode||winner||setTimeout(function(){play()},900):2===turn?modifyEventHandlers("getCellCoords(event)"):1===turn&&(modifyEventHandlers(""),setTimeout(function(){play()},1E3)):1===turn?modifyEventHandlers("getCellCoords(event)"):2===turn&&(modifyEventHandlers(""),setTimeout(function(){play()},1E3)))},checkWinner=function(){for(var a=[],b=[],d=!1,m=!1,
k=!1,e=!1,n=function(a,b,d){var c;1===b?c=[[a,0],[a,1],[a,2]]:2===b?c=[[0,a],[1,a],[2,a]]:3===b?c=[[0,0],[1,1],[2,2]]:4===b&&(c=[[2,0],[1,1],[0,2]]);for(a=0;6>a;a++)setTimeout(function(){for(var a={},b=0;b<c.length;a={cellId:a.cellId},b++)a.cellId=c[b][0]*gameBoard.length+c[b][1],document.getElementById(String(a.cellId)).classList.add(d),setTimeout(function(a){return function(){document.getElementById(String(a.cellId)).classList.remove(d)}}(a),250)},500*a)},c=0;c<gameBoard.length;c++){var g=[],h=
[],f=!1,p=!1,l=!1,r=!1;a[a.length]=gameBoard[c][c];b[b.length]=gameBoard[c][2-c];for(var q=0;q<gameBoard[c].length;q++)g[g.length]=gameBoard[c][q],h[h.length]=gameBoard[q][c];1===g[0]&&1===g[1]&&1===g[2]&&(f=!0,n(c,1,"xWin"));1===h[0]&&1===h[1]&&1===h[2]&&(p=!0,n(c,2,"xWin"));2===g[0]&&2===g[1]&&2===g[2]&&(l=!0,n(c,1,"oWin"));2===h[0]&&2===h[1]&&2===h[2]&&(r=!0,n(c,2,"oWin"));if(f||p)winner=1;else if(l||r)winner=2}1===a[0]&&1===a[1]&&1===a[2]&&(d=!0,n(0,3,"xWin"));1===b[0]&&1===b[1]&&1===b[2]&&(m=
!0,n(0,4,"xWin"));2===a[0]&&2===a[1]&&2===a[2]&&(k=!0,n(0,3,"oWin"));2===b[0]&&2===b[1]&&2===b[2]&&(e=!0,n(0,4,"oWin"));d||m?winner=1:k||e?winner=2:9!==turns||winner||(winner=-1)},twoOutOfThree=function(a){return 1===cellCheck(a[0])&&1===cellCheck(a[1])?1:2===cellCheck(a[0])&&2===cellCheck(a[1])?2:1===cellCheck(a[0])&&2===cellCheck(a[1])||2===cellCheck(a[0])&&1===cellCheck(a[1])?-1:0},emptyLine=function(a){var b=gameBoard[a[1].row][a[1].column],d=gameBoard[a[2].row][a[2].column];return gameBoard[a[0].row][a[0].column]||
b||d?!1:!0},cellsInDir=function(a,b,d,m){var k;0===d?k=[{row:a,column:0},{row:a,column:1},{row:a,column:2}]:1===d?k=[{row:0,column:b},{row:1,column:b},{row:2,column:b}]:2===d?k=[{row:0,column:0},{row:1,column:1},{row:2,column:2}]:3===d&&(k=[{row:0,column:2},{row:1,column:1},{row:2,column:0}]);if(m)if(0===d)for(a=0;a<k.length;a++)b===k[a].column&&k.splice(a,1);else for(b=0;b<k.length;b++)a===k[b].row&&k.splice(b,1);return k},play=function(){for(var a=[{score:0,valid:!1,diagA:!0,diagB:!1},{score:0,
valid:!1,diagA:!1,diagB:!1},{score:0,valid:!1,diagA:!1,diagB:!0},{score:0,valid:!1,diagA:!1,diagB:!1},{score:0,valid:!1,diagA:!0,diagB:!0},{score:0,valid:!1,diagA:!1,diagB:!1},{score:0,valid:!1,diagA:!1,diagB:!0},{score:0,valid:!1,diagA:!1,diagB:!1},{score:0,valid:!1,diagA:!0,diagB:!1}],b=-Infinity,d=0,m=[],k={row:0,column:0},e=0;e<gameBoard.length;e++)for(var n=0;n<gameBoard[e].length;n++){var c=gameBoard.length*e+n;if(0===gameBoard[e][n]){var g=cellsInDir(e,n,0,!0),h=cellsInDir(e,n,1,!0),f=void 0;
f=void 0;-1===twoOutOfThree(g)?--a[c].score:twoOutOfThree(g)!==turn&&0!==twoOutOfThree(g)?a[c].score+=3:twoOutOfThree(g)===turn&&0!==twoOutOfThree(g)&&(a[c].score+=4);-1===twoOutOfThree(h)?--a[c].score:twoOutOfThree(h)!==turn&&0!==twoOutOfThree(h)?a[c].score+=3:twoOutOfThree(h)===turn&&0!==twoOutOfThree(h)&&(a[c].score+=4);a[c].diagA&&(f=cellsInDir(e,n,2,!0),-1===twoOutOfThree(f)?--a[c].score:twoOutOfThree(f)!==turn&&0!==twoOutOfThree(f)?a[c].score+=3:twoOutOfThree(f)===turn&&0!==twoOutOfThree(f)&&
(a[c].score+=4));a[c].diagB&&(f=cellsInDir(e,n,3,!0),-1===twoOutOfThree(f)?--a[c].score:twoOutOfThree(f)!==turn&&0!==twoOutOfThree(f)?a[c].score+=3:twoOutOfThree(f)===turn&&0!==twoOutOfThree(f)&&(a[c].score+=4));if((0===e&&0===n||2===e&&2===n)&&3===turns){g=cellsInDir(0,0,0,!1);h=cellsInDir(2,2,0,!1);f=cellsInDir(0,0,1,!1);var p=cellsInDir(2,2,1,!1),l=function(b){for(var c=0;c<b.length;c++)--a[b[c].row*gameBoard.length+b[c].column].score};emptyLine(g)&&!emptyLine(h)?emptyLine(f)||emptyLine(p)?emptyLine(f)?
emptyLine(p)||(l(g),l(f)):(l(g),l(p)):l(g):!emptyLine(g)&&emptyLine(h)?emptyLine(f)||emptyLine(p)?emptyLine(f)?emptyLine(p)||(l(h),l(f)):(l(h),l(p)):l(h):emptyLine(f)&&!emptyLine(p)?emptyLine(g)||emptyLine(h)?emptyLine(g)?emptyLine(h)||(l(f),l(g)):(l(f),l(h)):l(f):!emptyLine(f)&&emptyLine(p)&&(emptyLine(g)||emptyLine(h)?emptyLine(g)?emptyLine(h)||(l(p),l(g)):(l(p),l(h)):l(p))}a[c].valid=!0}}0<turns&&(a[0].score+=2,a[2].score+=2,a[4].score+=420,a[6].score+=2,a[8].score+=2);gameBoard[0][0]===gameBoard[2][2]&&
gameBoard[0][0]&&(a[1].score+=2,a[3].score+=2,a[5].score+=2,a[7].score+=2);gameBoard[0][2]===gameBoard[2][0]&&gameBoard[0][2]&&(a[1].score+=2,a[3].score+=2,a[5].score+=2,a[7].score+=2);for(e=0;e<a.length;e++)a[e].score>b&&a[e].valid?(b=a[e].score,d=e,m.length=0,m[m.length]=e):a[e].score===b&&a[e].valid&&(m[m.length]=e);1<m.length&&(d=m[Math.floor(Math.random()*m.length)]);k.row=Math.floor(d/3);k.column=d%3;console.log(turns);console.log(k);console.log(a);console.log("");updateCell(k)};
window.onload=function(){loadRecord();reset()};