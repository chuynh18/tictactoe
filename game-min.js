var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,c){b!=Array.prototype&&b!=Object.prototype&&(b[a]=c.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var b=0;return function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+b++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var a=0;return $jscomp.iteratorPrototype(function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=b[Symbol.iterator];return a?a.call(b):$jscomp.arrayIterator(b)};
var gameBoard=[[0,0,0],[0,0,0],[0,0,0]],turn=1,turns=0,winner=0,mode=0,record={p1:0,p2:0,ties:0},ls=window.localStorage,saveRecord=function(){ls.setItem("record",JSON.stringify(record))},loadRecord=function(){var b=JSON.parse(ls.getItem("record"));b&&(b=$jscomp.makeIterator([b.p1,b.p2,b.ties]),record.p1=b.next().value,record.p2=b.next().value,record.ties=b.next().value)},reset=function(){gameBoard=[[0,0,0],[0,0,0],[0,0,0]];turn=1;mode=winner=turns=0;refreshDisplay();modifyEventHandlers("");document.getElementById("board").classList.add("hidden");
var b=document.getElementById("turn");b.textContent="Play as...";var a=document.createElement("div");a.id="start-buttons";var c=document.createElement("button"),l=document.createElement("button"),d=document.createElement("button"),q=document.createElement("button");c.textContent="Human vs Human";c.setAttribute("onclick","mode=1;showBoard();refreshDisplay();modifyEventHandlers('getCellCoords(event)');");l.textContent="Human vs CPU";l.setAttribute("onclick","mode=2;showBoard();refreshDisplay();modifyEventHandlers('getCellCoords(event)')");
d.textContent="CPU vs Human";d.setAttribute("onclick","mode=3;showBoard();modifyEventHandlers('');refreshDisplay();setTimeout(function(){play(true)},500)");q.textContent="Spectate CPU vs CPU";q.setAttribute("onclick","mode=4;showBoard();modifyEventHandlers('');refreshDisplay();setTimeout(function(){play(true)},900)");a.appendChild(c);a.appendChild(l);a.appendChild(d);a.appendChild(q);b.appendChild(a)},highlight=function(b,a){var c=Math.floor(Number(a.target.id)/3),l=Number(a.target.id)%3;b&&!gameBoard[c][l]&&
(2===mode&&1===turn||3===mode&&2===turn||1===mode)?a.target.classList.add("hover"):b||a.target.classList.remove("hover")},playSound=function(b){(new Audio(b)).play()},changeTurn=function(){1===turn?(playSound("x.webm"),turn++):(playSound("o.webm"),turn--);turns++},modifyEventHandlers=function(b){for(var a=document.getElementsByClassName("grid-item"),c=0;c<a.length;c++)a[c].setAttribute("onclick",b)},showBoard=function(){document.getElementById("board").classList.remove("hidden")},refreshDisplay=function(){var b=
document.getElementById("turn"),a=document.getElementsByTagName("html")[0],c=document.getElementById("board");if(1===winner)record.p1++,b.textContent="Player 1 wins",a.style.backgroundColor="#778899",c.style.backgroundColor="#2196F3";else if(2===winner)record.p2++,b.textContent="Player 2 wins",a.style.backgroundColor="#aa8484",c.style.backgroundColor="#f32121";else if(-1===winner)record.ties++,b.textContent="Tied game",a.style.backgroundColor="#c4fcc2",c.style.backgroundColor="#36fc2f";else if(!winner&&
mode){var l=document.createElement("div");l.id="start-buttons";var d=document.createElement("button");d.textContent="Give me a hint!";d.setAttribute("onclick","play(false)");l.appendChild(d);1===turn?(a.style.backgroundColor="#778899",c.style.backgroundColor="#2196F3",b.textContent="Player 1's turn",2===mode&&b.appendChild(l),3===mode&&(d.disabled=!0,b.appendChild(l))):(a.style.backgroundColor="#aa8484",c.style.backgroundColor="#f32121",b.textContent="Player 2's turn",2===mode&&(d.disabled=!0,b.appendChild(l)),
3===mode&&b.appendChild(l));1===mode&&b.appendChild(l)}document.getElementById("score").innerHTML="Player 1 wins: "+record.p1+"<br>Player 2 wins: "+record.p2+"<br>Ties: "+record.ties;winner&&(b=document.createElement("div"),b.id="start-buttons",a=document.createElement("button"),a.textContent="Play again!",a.setAttribute("onclick","reset();"),b.appendChild(a),document.getElementById("turn").appendChild(b),saveRecord());for(b=0;b<gameBoard.length;b++)for(a=0;a<gameBoard[b].length;a++)c=document.getElementById(String(gameBoard.length*
b+a)),1===gameBoard[b][a]?(c.textContent="X",c.classList.add("x")):2===gameBoard[b][a]?(c.textContent="O",c.classList.add("o")):(c.textContent="",c.classList.remove("x","xWin","o","oWin"))},cellCheck=function(b){return gameBoard[b.row][b.column]},getCellCoords=function(b){updateCell({row:Math.floor(Number(b.target.id)/3),column:Math.floor(Number(b.target.id)%3)})},updateCell=function(b){cellCheck(b)||winner||((gameBoard[b.row][b.column]=turn,changeTurn(),checkWinner(),refreshDisplay(),2!==mode||winner)?
3!==mode||winner?4!==mode||winner||setTimeout(function(){play(!0)},900):2===turn?modifyEventHandlers("getCellCoords(event)"):1===turn&&(modifyEventHandlers(""),setTimeout(function(){play(!0)},1E3)):1===turn?modifyEventHandlers("getCellCoords(event)"):2===turn&&(modifyEventHandlers(""),setTimeout(function(){play(!0)},1E3)))},checkWinner=function(){for(var b=[],a=[],c=!1,l=!1,d=!1,q=!1,f=function(a,b,c){var d;1===b?d=[[a,0],[a,1],[a,2]]:2===b?d=[[0,a],[1,a],[2,a]]:3===b?d=[[0,0],[1,1],[2,2]]:4===b&&
(d=[[2,0],[1,1],[0,2]]);for(a=0;6>a;a++)setTimeout(function(){for(var a={},b=0;b<d.length;a={cellId:a.cellId},b++)a.cellId=d[b][0]*gameBoard.length+d[b][1],document.getElementById(String(a.cellId)).classList.add(c),setTimeout(function(a){return function(){document.getElementById(String(a.cellId)).classList.remove(c)}}(a),250)},500*a)},k=0;k<gameBoard.length;k++){var e=[],h=[],n=!1,g=!1,p=!1,m=!1;b[b.length]=gameBoard[k][k];a[a.length]=gameBoard[k][2-k];for(var r=0;r<gameBoard[k].length;r++)e[e.length]=
gameBoard[k][r],h[h.length]=gameBoard[r][k];1===e[0]&&1===e[1]&&1===e[2]&&(n=!0,f(k,1,"xWin"));1===h[0]&&1===h[1]&&1===h[2]&&(g=!0,f(k,2,"xWin"));2===e[0]&&2===e[1]&&2===e[2]&&(p=!0,f(k,1,"oWin"));2===h[0]&&2===h[1]&&2===h[2]&&(m=!0,f(k,2,"oWin"));if(n||g)winner=1;else if(p||m)winner=2}1===b[0]&&1===b[1]&&1===b[2]&&(c=!0,f(0,3,"xWin"));1===a[0]&&1===a[1]&&1===a[2]&&(l=!0,f(0,4,"xWin"));2===b[0]&&2===b[1]&&2===b[2]&&(d=!0,f(0,3,"oWin"));2===a[0]&&2===a[1]&&2===a[2]&&(q=!0,f(0,4,"oWin"));c||l?winner=
1:d||q?winner=2:9!==turns||winner||(winner=-1)},twoOutOfThree=function(b){return 1===cellCheck(b[0])&&1===cellCheck(b[1])?1:2===cellCheck(b[0])&&2===cellCheck(b[1])?2:1===cellCheck(b[0])&&2===cellCheck(b[1])||2===cellCheck(b[0])&&1===cellCheck(b[1])?-1:0},emptyLine=function(b){var a=gameBoard[b[1].row][b[1].column],c=gameBoard[b[2].row][b[2].column];return gameBoard[b[0].row][b[0].column]||a||c?!1:!0},cellsInDir=function(b,a,c,l){var d;0===c?d=[{row:b,column:0},{row:b,column:1},{row:b,column:2}]:
1===c?d=[{row:0,column:a},{row:1,column:a},{row:2,column:a}]:2===c?d=[{row:0,column:0},{row:1,column:1},{row:2,column:2}]:3===c&&(d=[{row:0,column:2},{row:1,column:1},{row:2,column:0}]);if(l)if(0===c)for(b=0;b<d.length;b++)a===d[b].column&&d.splice(b,1);else for(a=0;a<d.length;a++)b===d[a].row&&d.splice(a,1);return d},play=function(b){for(var a=[{score:0,valid:!1,diagA:!0,diagB:!1},{score:0,valid:!1,diagA:!1,diagB:!1},{score:0,valid:!1,diagA:!1,diagB:!0},{score:0,valid:!1,diagA:!1,diagB:!1},{score:0,
valid:!1,diagA:!0,diagB:!0},{score:0,valid:!1,diagA:!1,diagB:!1},{score:0,valid:!1,diagA:!1,diagB:!0},{score:0,valid:!1,diagA:!1,diagB:!1},{score:0,valid:!1,diagA:!0,diagB:!1}],c=-Infinity,l=0,d=[],q={row:0,column:0},f=0;f<gameBoard.length;f++)for(var k=0;k<gameBoard[f].length;k++){var e=gameBoard.length*f+k;if(0===gameBoard[f][k]){var h=cellsInDir(f,k,0,!0),n=cellsInDir(f,k,1,!0),g=void 0;g=void 0;-1===twoOutOfThree(h)?--a[e].score:twoOutOfThree(h)!==turn&&0!==twoOutOfThree(h)?a[e].score+=3:twoOutOfThree(h)===
turn&&0!==twoOutOfThree(h)&&(a[e].score+=4);-1===twoOutOfThree(n)?--a[e].score:twoOutOfThree(n)!==turn&&0!==twoOutOfThree(n)?a[e].score+=3:twoOutOfThree(n)===turn&&0!==twoOutOfThree(n)&&(a[e].score+=4);a[e].diagA&&(g=cellsInDir(f,k,2,!0),-1===twoOutOfThree(g)?--a[e].score:twoOutOfThree(g)!==turn&&0!==twoOutOfThree(g)?a[e].score+=3:twoOutOfThree(g)===turn&&0!==twoOutOfThree(g)&&(a[e].score+=4));a[e].diagB&&(g=cellsInDir(f,k,3,!0),-1===twoOutOfThree(g)?--a[e].score:twoOutOfThree(g)!==turn&&0!==twoOutOfThree(g)?
a[e].score+=3:twoOutOfThree(g)===turn&&0!==twoOutOfThree(g)&&(a[e].score+=4));if((0===f&&0===k||2===f&&2===k)&&3===turns){h=cellsInDir(0,0,0,!1);n=cellsInDir(2,2,0,!1);g=cellsInDir(0,0,1,!1);var p=cellsInDir(2,2,1,!1),m=function(b){for(var c=0;c<b.length;c++)--a[b[c].row*gameBoard.length+b[c].column].score};emptyLine(h)&&!emptyLine(n)?emptyLine(g)||emptyLine(p)?emptyLine(g)?emptyLine(p)||(m(h),m(g)):(m(h),m(p)):m(h):!emptyLine(h)&&emptyLine(n)?emptyLine(g)||emptyLine(p)?emptyLine(g)?emptyLine(p)||
(m(n),m(g)):(m(n),m(p)):m(n):emptyLine(g)&&!emptyLine(p)?emptyLine(h)||emptyLine(n)?emptyLine(h)?emptyLine(n)||(m(g),m(h)):(m(g),m(n)):m(g):!emptyLine(g)&&emptyLine(p)&&(emptyLine(h)||emptyLine(n)?emptyLine(h)?emptyLine(n)||(m(p),m(h)):(m(p),m(n)):m(p))}a[e].valid=!0}}1===turns&&(a[4].score+=420);0<turns&&(a[0].score+=2,a[2].score+=2,a[6].score+=2,a[8].score+=2);gameBoard[0][0]===gameBoard[2][2]&&gameBoard[0][0]&&(a[1].score+=2,a[3].score+=2,a[5].score+=2,a[7].score+=2);gameBoard[0][2]===gameBoard[2][0]&&
gameBoard[0][2]&&(a[1].score+=2,a[3].score+=2,a[5].score+=2,a[7].score+=2);for(f=0;f<a.length;f++)a[f].score>c&&a[f].valid?(c=a[f].score,l=f,d.length=0,d[d.length]=f):a[f].score===c&&a[f].valid&&(d[d.length]=f);1<d.length&&(l=d[Math.floor(Math.random()*d.length)]);q.row=Math.floor(l/3);q.column=l%3;console.log("Turn:",turns);console.log("Play: "+q.row+", "+q.column);console.log(a);console.log("");if(b)updateCell(q);else for(b=function(a,b){var c=1===b?"xWin":"oWin";for(var d=0;3>d;d++)setTimeout(function(){document.getElementById(String(a)).classList.add(c);
setTimeout(function(){document.getElementById(String(a)).classList.remove(c)},250)},500*d)},c=0;c<d.length;c++)b(d[c],turn)};window.onload=function(){loadRecord();reset()};