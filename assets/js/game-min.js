var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,d){b!=Array.prototype&&b!=Object.prototype&&(b[a]=d.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var b=0;return function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+b++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var a=0;return $jscomp.iteratorPrototype(function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=b[Symbol.iterator];return a?a.call(b):$jscomp.arrayIterator(b)};$jscomp.arrayFromIterator=function(b){for(var a,d=[];!(a=b.next()).done;)d.push(a.value);return d};$jscomp.arrayFromIterable=function(b){return b instanceof Array?b:$jscomp.arrayFromIterator($jscomp.makeIterator(b))};
var gameBoard=[[0,0,0],[0,0,0],[0,0,0]],turn=1,inverseTurn=2,turns=0,winner=0,mode=0,record={p1:0,p2:0,ties:0},ls=window.localStorage,saveRecord=function(){ls.setItem("record",JSON.stringify(record))},loadRecord=function(){var b=JSON.parse(ls.getItem("record"));b&&(b=$jscomp.makeIterator([b.p1,b.p2,b.ties]),record.p1=b.next().value,record.p2=b.next().value,record.ties=b.next().value)},reset=function(){gameBoard=[[0,0,0],[0,0,0],[0,0,0]];turn=1;inverseTurn=2;mode=winner=turns=0;refreshDisplay();modifyEventHandlers("");
document.getElementById("board").classList.add("hidden");var b=document.getElementById("turn");b.textContent="Play as...";var a=document.createElement("div");a.id="start-buttons";var d=document.createElement("button"),l=document.createElement("button"),h=document.createElement("button"),r=document.createElement("button");d.textContent="Human vs Human";d.setAttribute("onclick","mode=1;showBoard();refreshDisplay();modifyEventHandlers('getCellCoords(event)');");l.textContent="Human vs CPU";l.setAttribute("onclick",
"mode=2;showBoard();refreshDisplay();modifyEventHandlers('getCellCoords(event)')");h.textContent="CPU vs Human";h.setAttribute("onclick","mode=3;showBoard();modifyEventHandlers('');refreshDisplay();setTimeout(function(){play(true)},500)");r.textContent="Spectate CPU vs CPU";r.setAttribute("onclick","mode=4;showBoard();modifyEventHandlers('');refreshDisplay();setTimeout(function(){play(true)},900)");a.appendChild(d);a.appendChild(l);a.appendChild(h);a.appendChild(r);b.appendChild(a)},highlight=function(b,
a){var d=Math.floor(Number(a.target.id)/3),l=Number(a.target.id)%3;b&&!gameBoard[d][l]&&(2===mode&&1===turn||3===mode&&2===turn||1===mode)?a.target.classList.add("hover"):b||a.target.classList.remove("hover")},playSound=function(b){(new Audio(b)).play()},changeTurn=function(){1===turn?(playSound("assets/snd/x.webm"),turn++,inverseTurn--):(playSound("assets/snd/o.webm"),turn--,inverseTurn++);turns++},modifyEventHandlers=function(b){for(var a=document.getElementsByClassName("grid-item"),d=0;d<a.length;d++)a[d].setAttribute("onclick",
b)},showBoard=function(){document.getElementById("board").classList.remove("hidden")},blink=function(b,a,d){var l=1===a?"xWin":"oWin";for(a=0;a<d;a++)setTimeout(function(){document.getElementById(String(b)).classList.add(l);setTimeout(function(){document.getElementById(String(b)).classList.remove(l)},250)},500*a)},refreshDisplay=function(){var b=document.getElementById("turn"),a=document.getElementsByTagName("html")[0],d=document.getElementById("board");if(1===winner)record.p1++,b.textContent="Player 1 wins",
a.style.backgroundColor="#778899",d.style.backgroundColor="#2196F3";else if(2===winner)record.p2++,b.textContent="Player 2 wins",a.style.backgroundColor="#aa8484",d.style.backgroundColor="#f32121";else if(-1===winner)record.ties++,b.textContent="Tied game",a.style.backgroundColor="#c4fcc2",d.style.backgroundColor="#36fc2f";else if(!winner&&mode){var l=document.createElement("div");l.id="start-buttons";var h=document.createElement("button");h.textContent="Give me a hint!";h.setAttribute("onclick",
"play(false)");l.appendChild(h);1===turn?(a.style.backgroundColor="#778899",d.style.backgroundColor="#2196F3",b.textContent="Player 1's turn",2===mode&&b.appendChild(l),3===mode&&(h.disabled=!0,b.appendChild(l))):(a.style.backgroundColor="#aa8484",d.style.backgroundColor="#f32121",b.textContent="Player 2's turn",2===mode&&(h.disabled=!0,b.appendChild(l)),3===mode&&b.appendChild(l));1===mode&&b.appendChild(l)}document.getElementById("score").innerHTML="Player 1 wins: "+record.p1+"<br>Player 2 wins: "+
record.p2+"<br>Ties: "+record.ties;winner&&(b=document.createElement("div"),b.id="start-buttons",a=document.createElement("button"),a.textContent="Play again!",a.setAttribute("onclick","reset();"),b.appendChild(a),document.getElementById("turn").appendChild(b),saveRecord());for(b=0;b<gameBoard.length;b++)for(a=0;a<gameBoard[b].length;a++)d=document.getElementById(String(gameBoard.length*b+a)),1===gameBoard[b][a]?(d.textContent="X",d.classList.add("x")):2===gameBoard[b][a]?(d.textContent="O",d.classList.add("o")):
(d.textContent="",d.classList.remove("x","xWin","o","oWin"))},cellCheck=function(b,a){return a?a[b.row][b.column]:gameBoard[b.row][b.column]},getCellCoords=function(b){updateCell({row:Math.floor(Number(b.target.id)/3),column:Math.floor(Number(b.target.id)%3),cellId:b.target.id})},updateCell=function(b){cellCheck(b)||winner||((gameBoard[b.row][b.column]=turn,blink(b.cellId,turn,1),changeTurn(),checkWinner(),refreshDisplay(),2!==mode||winner)?3!==mode||winner?4!==mode||winner||setTimeout(function(){play(!0)},
900):2===turn?modifyEventHandlers("getCellCoords(event)"):1===turn&&(modifyEventHandlers(""),setTimeout(function(){play(!0)},1E3)):1===turn?modifyEventHandlers("getCellCoords(event)"):2===turn&&(modifyEventHandlers(""),setTimeout(function(){play(!0)},1E3)))},checkWinner=function(){for(var b=[],a=[],d=!1,l=!1,h=!1,r=!1,g=function(a,b){var c;1===b?c=[a*gameBoard.length,a*gameBoard.length+1,a*gameBoard.length+2]:2===b?c=[a,gameBoard.length+a,2*gameBoard.length+a]:3===b?c=[0,4,8]:4===b&&(c=[2,4,6]);for(var d=
0;d<c.length;d++)blink(c[d],inverseTurn,6)},m=0;m<gameBoard.length;m++){var c=[],n=[],p=!1,e=!1,k=!1,f=!1;b[b.length]=gameBoard[m][m];a[a.length]=gameBoard[m][2-m];for(var q=0;q<gameBoard[m].length;q++)c[c.length]=gameBoard[m][q],n[n.length]=gameBoard[q][m];1===c[0]&&1===c[1]&&1===c[2]&&(p=!0,g(m,1));1===n[0]&&1===n[1]&&1===n[2]&&(e=!0,g(m,2));2===c[0]&&2===c[1]&&2===c[2]&&(k=!0,g(m,1));2===n[0]&&2===n[1]&&2===n[2]&&(f=!0,g(m,2));if(p||e)winner=1;else if(k||f)winner=2}1===b[0]&&1===b[1]&&1===b[2]&&
(d=!0,g(0,3,"xWin"));1===a[0]&&1===a[1]&&1===a[2]&&(l=!0,g(0,4,"xWin"));2===b[0]&&2===b[1]&&2===b[2]&&(h=!0,g(0,3,"oWin"));2===a[0]&&2===a[1]&&2===a[2]&&(r=!0,g(0,4,"oWin"));d||l?winner=1:h||r?winner=2:9!==turns||winner||(winner=-1)},twoOutOfThree=function(b,a){return 1===cellCheck(b[0],a)&&1===cellCheck(b[1],a)?1:2===cellCheck(b[0],a)&&2===cellCheck(b[1],a)?2:1===cellCheck(b[0],a)&&2===cellCheck(b[1],a)||2===cellCheck(b[0],a)&&1===cellCheck(b[1],a)?-1:0},emptyLine=function(b){var a=gameBoard[b[1].row][b[1].column],
d=gameBoard[b[2].row][b[2].column];return gameBoard[b[0].row][b[0].column]||a||d?!1:!0},cellsInDir=function(b,a,d,l){var h;0===d?h=[{row:b,column:0},{row:b,column:1},{row:b,column:2}]:1===d?h=[{row:0,column:a},{row:1,column:a},{row:2,column:a}]:2===d?h=[{row:0,column:0},{row:1,column:1},{row:2,column:2}]:3===d&&(h=[{row:0,column:2},{row:1,column:1},{row:2,column:0}]);if(l)if(0===d)for(b=0;b<h.length;b++)a===h[b].column&&h.splice(b,1);else for(a=0;a<h.length;a++)b===h[a].row&&h.splice(a,1);return h},
play=function(b){var a=[{score:1,valid:!1,diagA:!0,diagB:!1},{score:0,valid:!1,diagA:!1,diagB:!1},{score:1,valid:!1,diagA:!1,diagB:!0},{score:0,valid:!1,diagA:!1,diagB:!1},{score:1,valid:!1,diagA:!0,diagB:!0},{score:0,valid:!1,diagA:!1,diagB:!1},{score:1,valid:!1,diagA:!1,diagB:!0},{score:0,valid:!1,diagA:!1,diagB:!1},{score:1,valid:!1,diagA:!0,diagB:!1}],d=-Infinity,l=0,h=[],r={row:0,column:0,cellId:0};if(featureToggle.playNonDiagonals)for(var g=0;g<a.length;g+=2)a[g].score=0;for(g=0;g<gameBoard.length;g++)for(var m=
0;m<gameBoard[g].length;m++){var c=gameBoard.length*g+m;if(0===gameBoard[g][m]){var n=cellsInDir(g,m,0,!0),p=cellsInDir(g,m,1,!0),e=void 0;e=e=void 0;if(featureToggle.lookAhead){e=[].concat($jscomp.arrayFromIterable(gameBoard));e[g][m]=turn;var k=cellsInDir(1,1,2,!1),f=cellsInDir(1,1,3,!1);a[c].diagA&&(twoOutOfThree([k[0],k[1]],e)===turn&&k[2]!==inverseTurn&&(a[c].score+=2),twoOutOfThree([k[0],k[2]],e)===turn&&k[1]!==inverseTurn&&(a[c].score+=2),twoOutOfThree([k[1],k[2]],e)===turn&&k[0]!==inverseTurn&&
(a[c].score+=2));a[c].diagB&&(twoOutOfThree([f[0],f[1]],e)===turn&&f[2]!==inverseTurn&&(a[c].score+=2),twoOutOfThree([f[0],f[2]],e)===turn&&f[1]!==inverseTurn&&(a[c].score+=2),twoOutOfThree([f[1],f[2]],e)===turn&&f[0]!==inverseTurn&&(a[c].score+=2));for(k=0;k<gameBoard.length;k++){f=cellsInDir(k,k,0,!1);var q=cellsInDir(k,k,1,!1);twoOutOfThree([f[0],f[1]],e)===turn&&f[2]!==inverseTurn&&(a[c].score+=2);twoOutOfThree([f[0],f[2]],e)===turn&&f[1]!==inverseTurn&&(a[c].score+=2);twoOutOfThree([f[1],f[2]],
e)===turn&&f[0]!==inverseTurn&&(a[c].score+=2);twoOutOfThree([q[0],q[1]],e)===turn&&q[2]!==inverseTurn&&(a[c].score+=2);twoOutOfThree([q[0],q[2]],e)===turn&&q[1]!==inverseTurn&&(a[c].score+=2);twoOutOfThree([q[1],q[2]],e)===turn&&q[0]!==inverseTurn&&(a[c].score+=2)}e[g][m]=0}-1===twoOutOfThree(n)?--a[c].score:twoOutOfThree(n)!==turn&&0!==twoOutOfThree(n)?a[c].score+=9:twoOutOfThree(n)===turn&&0!==twoOutOfThree(n)&&(a[c].score+=10);-1===twoOutOfThree(p)?--a[c].score:twoOutOfThree(p)!==turn&&0!==twoOutOfThree(p)?
a[c].score+=9:twoOutOfThree(p)===turn&&0!==twoOutOfThree(p)&&(a[c].score+=10);a[c].diagA&&(e=cellsInDir(g,m,2,!0),-1===twoOutOfThree(e)?gameBoard[1][1]===inverseTurn?a[c].score+=1:--a[c].score:twoOutOfThree(e)!==turn&&0!==twoOutOfThree(e)?a[c].score+=9:twoOutOfThree(e)===turn&&0!==twoOutOfThree(e)&&(a[c].score+=10));a[c].diagB&&(e=cellsInDir(g,m,3,!0),-1===twoOutOfThree(e)?gameBoard[1][1]===inverseTurn?a[c].score+=1:--a[c].score:twoOutOfThree(e)!==turn&&0!==twoOutOfThree(e)?a[c].score+=9:twoOutOfThree(e)===
turn&&0!==twoOutOfThree(e)&&(a[c].score+=10));featureToggle.playNonDiagonals&&(0===g&&0===m||2===g&&2===m)&&3===turns&&((n=cellsInDir(0,0,0,!1),p=cellsInDir(2,2,0,!1),e=cellsInDir(0,0,1,!1),k=cellsInDir(2,2,1,!1),f=function(b){for(var c=0;c<b.length;c++)--a[b[c].row*gameBoard.length+b[c].column].score},emptyLine(n)&&!emptyLine(p))?emptyLine(e)||emptyLine(k)?emptyLine(e)?emptyLine(k)||(f(n),f(e)):(f(n),f(k)):f(n):!emptyLine(n)&&emptyLine(p)?emptyLine(e)||emptyLine(k)?emptyLine(e)?emptyLine(k)||(f(p),
f(e)):(f(p),f(k)):f(p):emptyLine(e)&&!emptyLine(k)?emptyLine(n)||emptyLine(p)?emptyLine(n)?emptyLine(p)||(f(e),f(n)):(f(e),f(p)):f(e):!emptyLine(e)&&emptyLine(k)&&(emptyLine(n)||emptyLine(p)?emptyLine(n)?emptyLine(p)||(f(k),f(n)):(f(k),f(p)):f(k)));a[c].valid=!0}}1===turns&&(a[4].score+=420);0<turns&&(a[0].score+=1,a[2].score+=1,a[4].score+=1,a[6].score+=1,a[8].score+=1);gameBoard[0][0]===gameBoard[2][2]&&gameBoard[0][0]&&(a[1].score+=3,a[3].score+=3,a[5].score+=3,a[7].score+=3);gameBoard[0][2]===
gameBoard[2][0]&&gameBoard[0][2]&&(a[1].score+=3,a[3].score+=3,a[5].score+=3,a[7].score+=3);for(g=0;g<a.length;g++)a[g].score>d&&a[g].valid?(d=a[g].score,l=g,h.length=0,h[h.length]=g):a[g].score===d&&a[g].valid&&(h[h.length]=g);1<h.length&&(l=h[Math.floor(Math.random()*h.length)]);r.row=Math.floor(l/gameBoard.length);r.column=l%gameBoard.length;r.cellId=l;console.log("Turn:",turns);console.log("Play: "+r.row+", "+r.column);console.log(a);console.log("");if(b)updateCell(r);else for(b=0;b<h.length;b++)blink(h[b],
turn,3)};window.onload=function(){loadRecord();reset()};window.ondragstart=function(){return!1};