var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,a,d){b!=Array.prototype&&b!=Object.prototype&&(b[a]=d.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var b=0;return function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+b++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var a=0;return $jscomp.iteratorPrototype(function(){return a<b.length?{done:!1,value:b[a++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();$jscomp.initSymbol();$jscomp.initSymbolIterator();var a=b[Symbol.iterator];return a?a.call(b):$jscomp.arrayIterator(b)};
var gameBoard=[[0,0,0],[0,0,0],[0,0,0]],turn=1,inverseTurn=2,turns=0,winner=0,mode=0,record={p1:0,p2:0,ties:0},ls=window.localStorage,saveRecord=function(){ls.setItem("record",JSON.stringify(record))},loadRecord=function(){var b=JSON.parse(ls.getItem("record"));b&&(b=$jscomp.makeIterator([b.p1,b.p2,b.ties]),record.p1=b.next().value,record.p2=b.next().value,record.ties=b.next().value)},reset=function(){gameBoard=[[0,0,0],[0,0,0],[0,0,0]];turn=1;inverseTurn=2;mode=winner=turns=0;refreshDisplay();modifyEventHandlers("");
document.getElementById("board").classList.add("hidden");var b=document.getElementById("turn");b.textContent="Play as...";var a=document.createElement("div");a.id="start-buttons";var d=document.createElement("button"),h=document.createElement("button"),f=document.createElement("button"),q=document.createElement("button");d.textContent="Human vs Human";d.setAttribute("onclick","mode=1;showBoard();refreshDisplay();modifyEventHandlers('getCellCoords(event)');");h.textContent="Human vs CPU";h.setAttribute("onclick",
"mode=2;showBoard();refreshDisplay();modifyEventHandlers('getCellCoords(event)')");f.textContent="CPU vs Human";f.setAttribute("onclick","mode=3;showBoard();modifyEventHandlers('');refreshDisplay();setTimeout(function(){play(true)},500)");q.textContent="Spectate CPU vs CPU";q.setAttribute("onclick","mode=4;showBoard();modifyEventHandlers('');refreshDisplay();setTimeout(function(){play(true)},900)");a.appendChild(d);a.appendChild(h);a.appendChild(f);a.appendChild(q);b.appendChild(a)},highlight=function(b,
a){var d=Math.floor(Number(a.target.id)/3),h=Number(a.target.id)%3;b&&!gameBoard[d][h]&&(2===mode&&1===turn||3===mode&&2===turn||1===mode)?a.target.classList.add("hover"):b||a.target.classList.remove("hover")},playSound=function(b){(new Audio(b)).play()},changeTurn=function(){1===turn?(playSound("assets/snd/x.webm"),turn++,inverseTurn--):(playSound("assets/snd/o.webm"),turn--,inverseTurn++);turns++},modifyEventHandlers=function(b){for(var a=document.getElementsByClassName("grid-item"),d=0;d<a.length;d++)a[d].setAttribute("onclick",
b)},showBoard=function(){document.getElementById("board").classList.remove("hidden")},blink=function(b,a,d){var h=1===a?"xWin":"oWin";for(a=0;a<d;a++)setTimeout(function(){document.getElementById(String(b)).classList.add(h);setTimeout(function(){document.getElementById(String(b)).classList.remove(h)},250)},500*a)},refreshDisplay=function(){var b=document.getElementById("turn"),a=document.getElementsByTagName("html")[0],d=document.getElementById("board");if(1===winner)record.p1++,b.textContent="Player 1 wins",
a.style.backgroundColor="#778899",d.style.backgroundColor="#2196F3";else if(2===winner)record.p2++,b.textContent="Player 2 wins",a.style.backgroundColor="#aa8484",d.style.backgroundColor="#f32121";else if(-1===winner)record.ties++,b.textContent="Tied game",a.style.backgroundColor="#c4fcc2",d.style.backgroundColor="#36fc2f";else if(!winner&&mode){var h=document.createElement("div");h.id="start-buttons";var f=document.createElement("button");f.textContent="Give me a hint!";f.setAttribute("onclick",
"play(false)");h.appendChild(f);1===turn?(a.style.backgroundColor="#778899",d.style.backgroundColor="#2196F3",b.textContent="Player 1's turn",2===mode&&b.appendChild(h),3===mode&&(f.disabled=!0,b.appendChild(h))):(a.style.backgroundColor="#aa8484",d.style.backgroundColor="#f32121",b.textContent="Player 2's turn",2===mode&&(f.disabled=!0,b.appendChild(h)),3===mode&&b.appendChild(h));1===mode&&b.appendChild(h)}document.getElementById("score").innerHTML="Player 1 wins: "+record.p1+"<br>Player 2 wins: "+
record.p2+"<br>Ties: "+record.ties;winner&&(b=document.createElement("div"),b.id="start-buttons",a=document.createElement("button"),a.textContent="Play again!",a.setAttribute("onclick","reset();"),b.appendChild(a),document.getElementById("turn").appendChild(b),saveRecord());for(b=0;b<gameBoard.length;b++)for(a=0;a<gameBoard[b].length;a++)d=document.getElementById(String(gameBoard.length*b+a)),1===gameBoard[b][a]?(d.textContent="X",d.classList.add("x")):2===gameBoard[b][a]?(d.textContent="O",d.classList.add("o")):
(d.textContent="",d.classList.remove("x","xWin","o","oWin"))},cellCheck=function(b,a){return a?a[b.row][b.column]:gameBoard[b.row][b.column]},getCellCoords=function(b){updateCell({row:Math.floor(Number(b.target.id)/3),column:Math.floor(Number(b.target.id)%3),cellId:b.target.id})},updateCell=function(b){cellCheck(b)||winner||((gameBoard[b.row][b.column]=turn,blink(b.cellId,turn,1),changeTurn(),checkWinner(),refreshDisplay(),2!==mode||winner)?3!==mode||winner?4!==mode||winner||setTimeout(function(){play(!0)},
900):2===turn?modifyEventHandlers("getCellCoords(event)"):1===turn&&(modifyEventHandlers(""),setTimeout(function(){play(!0)},1E3)):1===turn?modifyEventHandlers("getCellCoords(event)"):2===turn&&(modifyEventHandlers(""),setTimeout(function(){play(!0)},1E3)))},checkWinner=function(){for(var b=[],a=[],d=!1,h=!1,f=!1,q=!1,e=function(a,b){var c;1===b?c=[a*gameBoard.length,a*gameBoard.length+1,a*gameBoard.length+2]:2===b?c=[a,gameBoard.length+a,2*gameBoard.length+a]:3===b?c=[0,4,8]:4===b&&(c=[2,4,6]);for(var d=
0;d<c.length;d++)blink(c[d],inverseTurn,6)},k=0;k<gameBoard.length;k++){var c=[],m=[],n=!1,g=!1,p=!1,l=!1;b[b.length]=gameBoard[k][k];a[a.length]=gameBoard[k][2-k];for(var r=0;r<gameBoard[k].length;r++)c[c.length]=gameBoard[k][r],m[m.length]=gameBoard[r][k];1===c[0]&&1===c[1]&&1===c[2]&&(n=!0,e(k,1));1===m[0]&&1===m[1]&&1===m[2]&&(g=!0,e(k,2));2===c[0]&&2===c[1]&&2===c[2]&&(p=!0,e(k,1));2===m[0]&&2===m[1]&&2===m[2]&&(l=!0,e(k,2));if(n||g)winner=1;else if(p||l)winner=2}1===b[0]&&1===b[1]&&1===b[2]&&
(d=!0,e(0,3,"xWin"));1===a[0]&&1===a[1]&&1===a[2]&&(h=!0,e(0,4,"xWin"));2===b[0]&&2===b[1]&&2===b[2]&&(f=!0,e(0,3,"oWin"));2===a[0]&&2===a[1]&&2===a[2]&&(q=!0,e(0,4,"oWin"));d||h?winner=1:f||q?winner=2:9!==turns||winner||(winner=-1)},twoOutOfThree=function(b,a){return 1===cellCheck(b[0],a)&&1===cellCheck(b[1],a)?1:2===cellCheck(b[0],a)&&2===cellCheck(b[1],a)?2:1===cellCheck(b[0],a)&&2===cellCheck(b[1],a)||2===cellCheck(b[0],a)&&1===cellCheck(b[1],a)?-1:0},emptyLine=function(b){var a=gameBoard[b[1].row][b[1].column],
d=gameBoard[b[2].row][b[2].column];return gameBoard[b[0].row][b[0].column]||a||d?!1:!0},cellsInDir=function(b,a,d,h){var f;0===d?f=[{row:b,column:0},{row:b,column:1},{row:b,column:2}]:1===d?f=[{row:0,column:a},{row:1,column:a},{row:2,column:a}]:2===d?f=[{row:0,column:0},{row:1,column:1},{row:2,column:2}]:3===d&&(f=[{row:0,column:2},{row:1,column:1},{row:2,column:0}]);if(h)if(0===d)for(b=0;b<f.length;b++)a===f[b].column&&f.splice(b,1);else for(a=0;a<f.length;a++)b===f[a].row&&f.splice(a,1);return f},
play=function(b){var a=[{score:1,valid:!1,voters:[],diagA:!0,diagB:!1},{score:0,valid:!1,voters:[],diagA:!1,diagB:!1},{score:1,valid:!1,voters:[],diagA:!1,diagB:!0},{score:0,valid:!1,voters:[],diagA:!1,diagB:!1},{score:1,valid:!1,voters:[],diagA:!0,diagB:!0},{score:0,valid:!1,voters:[],diagA:!1,diagB:!1},{score:1,valid:!1,voters:[],diagA:!1,diagB:!0},{score:0,valid:!1,voters:[],diagA:!1,diagB:!1},{score:1,valid:!1,voters:[],diagA:!0,diagB:!1}],d=-Infinity,h=0,f=[],q={row:0,column:0,cellId:0};if(featureToggle.playNonDiagonals)for(var e=
0;e<a.length;e+=2)a[e].score=0,a[e].voters[a[e].voters.length]="playNonDiagonals";for(e=0;e<gameBoard.length;e++)for(var k=0;k<gameBoard[e].length;k++){var c=gameBoard.length*e+k;if(0===gameBoard[e][k]){var m=cellsInDir(e,k,0,!0),n=cellsInDir(e,k,1,!0),g=void 0;g=void 0;if(featureToggle.lookAhead){g=[[Array.from(gameBoard[0])],[Array.from(gameBoard[1])],[Array.from(gameBoard[2])]];g[e][k]=turn;for(var p=cellsInDir(1,1,2,!1),l=cellsInDir(1,1,3,!1),r=0;2>=r;r++){var t=[0,1,2];t.splice(r,1);a[c].diagA&&
twoOutOfThree([p[t[0]],p[t[1]]],g)===turn&&p[r]!==inverseTurn&&(a[c].score+=2,a[c].voters[a[c].voters.length]="lookAheadDiagA");a[c].diagB&&twoOutOfThree([l[t[0]],l[t[1]]],g)===turn&&l[r]!==inverseTurn&&(a[c].score+=2,a[c].voters[a[c].voters.length]="lookAheadDiagB");var u=cellsInDir(e,k,0,!1),v=cellsInDir(e,k,1,!1);twoOutOfThree([u[t[0]],u[t[1]]],g)===turn&&u[r]!==inverseTurn&&(a[c].score+=2,a[c].voters[a[c].voters.length]="lookAheadRow");twoOutOfThree([v[t[0]],v[t[1]]],g)===turn&&v[r]!==inverseTurn&&
(a[c].score+=2,a[c].voters[a[c].voters.length]="lookAheadCol")}}-1===twoOutOfThree(m)?(--a[c].score,a[c].voters[a[c].voters.length]="deadRow"):twoOutOfThree(m)!==turn&&0!==twoOutOfThree(m)?(a[c].score+=9,a[c].voters[a[c].voters.length]="preventOpponentWin"):twoOutOfThree(m)===turn&&0!==twoOutOfThree(m)&&(a[c].score+=10,a[c].voters[a[c].voters.length]="winningPlay");-1===twoOutOfThree(n)?(--a[c].score,a[c].voters[a[c].voters.length]="deadColumn"):twoOutOfThree(n)!==turn&&0!==twoOutOfThree(n)?(a[c].score+=
9,a[c].voters[a[c].voters.length]="preventOpponentWin"):twoOutOfThree(n)===turn&&0!==twoOutOfThree(n)&&(a[c].score+=10,a[c].voters[a[c].voters.length]="winningPlay");a[c].diagA&&(g=cellsInDir(e,k,2,!0),-1===twoOutOfThree(g)?gameBoard[1][1]===inverseTurn?(a[c].score+=1,a[c].voters[a[c].voters.length]="diagATrap"):(--a[c].score,a[c].voters[a[c].voters.length]="deadDiagA"):twoOutOfThree(g)!==turn&&0!==twoOutOfThree(g)?(a[c].score+=9,a[c].voters[a[c].voters.length]="preventOpponentWin"):twoOutOfThree(g)===
turn&&0!==twoOutOfThree(g)&&(a[c].score+=10,a[c].voters[a[c].voters.length]="winningPlay"));a[c].diagB&&(g=cellsInDir(e,k,3,!0),-1===twoOutOfThree(g)?gameBoard[1][1]===inverseTurn?(a[c].score+=1,a[c].voters[a[c].voters.length]="diagBTrap"):(--a[c].score,a[c].voters[a[c].voters.length]="deadDiagB"):twoOutOfThree(g)!==turn&&0!==twoOutOfThree(g)?(a[c].score+=9,a[c].voters[a[c].voters.length]="preventOpponentWin"):twoOutOfThree(g)===turn&&0!==twoOutOfThree(g)&&(a[c].score+=10,a[c].voters[a[c].voters.length]=
"winningPlay"));featureToggle.playNonDiagonals&&(0===e&&0===k||2===e&&2===k)&&3===turns&&((m=cellsInDir(0,0,0,!1),n=cellsInDir(2,2,0,!1),g=cellsInDir(0,0,1,!1),p=cellsInDir(2,2,1,!1),l=function(b){for(var c=0;c<b.length;c++){var d=b[c].row*gameBoard.length+b[c].column;--a[d].score;a[d].voters[a[d].voters.length]="avoidBlankLine"}},emptyLine(m)&&!emptyLine(n))?emptyLine(g)||emptyLine(p)?emptyLine(g)?emptyLine(p)||(l(m),l(g)):(l(m),l(p)):l(m):!emptyLine(m)&&emptyLine(n)?emptyLine(g)||emptyLine(p)?emptyLine(g)?
emptyLine(p)||(l(n),l(g)):(l(n),l(p)):l(n):emptyLine(g)&&!emptyLine(p)?emptyLine(m)||emptyLine(n)?emptyLine(m)?emptyLine(n)||(l(g),l(m)):(l(g),l(n)):l(g):!emptyLine(g)&&emptyLine(p)&&(emptyLine(m)||emptyLine(n)?emptyLine(m)?emptyLine(n)||(l(p),l(m)):(l(p),l(n)):l(p)));a[c].valid=!0}}1===turns&&(a[4].score+=419,a[4].voters[a[4].voters.length]="centerOpenTurn2");0<turns&&(a[0].score+=1,a[2].score+=1,a[4].score+=1,a[6].score+=1,a[8].score+=1,a[0].voters[a[0].voters.length]="valueAddAfterFirstTurn",a[2].voters[a[2].voters.length]=
"valueAddAfterFirstTurn",a[4].voters[a[4].voters.length]="valueAddAfterFirstTurn",a[6].voters[a[6].voters.length]="valueAddAfterFirstTurn",a[8].voters[a[8].voters.length]="valueAddAfterFirstTurn");gameBoard[0][0]===gameBoard[2][2]&&gameBoard[0][0]===inverseTurn&&(a[1].score+=3,a[3].score+=3,a[5].score+=3,a[7].score+=3,a[1].voters[a[1].voters.length]="avoidDiagonalTrap",a[3].voters[a[3].voters.length]="avoidDiagonalTrap",a[5].voters[a[5].voters.length]="avoidDiagonalTrap",a[7].voters[a[7].voters.length]=
"avoidDiagonalTrap");gameBoard[0][2]===gameBoard[2][0]&&gameBoard[0][2]===inverseTurn&&(a[1].score+=3,a[3].score+=3,a[5].score+=3,a[7].score+=3,a[1].voters[a[1].voters.length]="avoidDiagonalTrap",a[3].voters[a[3].voters.length]="avoidDiagonalTrap",a[5].voters[a[5].voters.length]="avoidDiagonalTrap",a[7].voters[a[7].voters.length]="avoidDiagonalTrap");for(e=0;e<a.length;e++)a[e].score>d&&a[e].valid?(d=a[e].score,h=e,f.length=0,f[f.length]=e):a[e].score===d&&a[e].valid&&(f[f.length]=e);1<f.length&&
(h=f[Math.floor(Math.random()*f.length)]);q.row=Math.floor(h/gameBoard.length);q.column=h%gameBoard.length;q.cellId=h;console.log("Turn:",turns);console.log("Play: "+q.row+", "+q.column);console.log(a);console.log("");if(b)updateCell(q);else for(b=0;b<f.length;b++)blink(f[b],turn,3)};window.onload=function(){loadRecord();reset()};window.ondragstart=function(){return!1};